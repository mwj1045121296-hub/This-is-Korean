<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­éŸ©è¯æ±‡å¡”é˜²æ¸¸æˆ | í•œì¤‘ ì–´íœ˜ íƒ€ì›Œ ë””íœìŠ¤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', 'Microsoft YaHei', 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #fff;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* æ ‡é¢˜ */
        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
            background: linear-gradient(90deg, #00d4ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            color: #aaa;
            margin-bottom: 30px;
        }

        /* ç™»å½•ç•Œé¢ */
        #loginScreen {
            text-align: center;
            padding: 50px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 500px;
            margin: 0 auto;
        }

        #loginScreen h2 {
            color: #00d4ff;
            margin-bottom: 30px;
            font-size: 2em;
        }

        #loginScreen p {
            color: #aaa;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .input-group {
            margin-bottom: 30px;
        }

        .input-group label {
            display: block;
            color: #00d4ff;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        #playerNameInput {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #00d4ff;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            text-align: center;
            transition: all 0.3s;
        }

        #playerNameInput:focus {
            outline: none;
            border-color: #00ff88;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        #playerNameInput::placeholder {
            color: #666;
        }

        /* å¼€å§‹ç•Œé¢ */
        #startScreen {
            text-align: center;
            padding: 50px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
        }

        #startScreen h2 {
            color: #00d4ff;
            margin-bottom: 20px;
        }

        .welcome-message {
            font-size: 1.5em;
            color: #00ff88;
            margin-bottom: 30px;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        .btn {
            padding: 15px 40px;
            font-size: 1.2em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            text-transform: uppercase;
            margin: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00d4ff, #00ff88);
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.5);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 2px solid #00d4ff;
        }

        .btn-secondary:hover {
            background: rgba(0, 212, 255, 0.2);
            transform: translateY(-3px);
        }

        /* æ¸¸æˆç•Œé¢ */
        #gameScreen {
            display: none;
        }

        /* ç©å®¶ä¿¡æ¯æ  */
        .player-info {
            background: rgba(0, 212, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid rgba(0, 212, 255, 0.3);
        }

        .player-info .player-name {
            font-size: 1.3em;
            color: #00ff88;
            font-weight: bold;
        }

        /* çŠ¶æ€æ  */
        .status-bar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            text-align: center;
        }

        .stat-label {
            font-size: 0.9em;
            color: #aaa;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #00d4ff;
        }

        /* æ¸¸æˆç”»å¸ƒ */
        #gameCanvas {
            width: 100%;
            height: 400px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 2px solid rgba(0, 212, 255, 0.3);
            margin-bottom: 20px;
            display: block;
        }

        /* é¢˜ç›®åŒºåŸŸ */
        .question-area {
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            border: 2px solid rgba(0, 212, 255, 0.3);
        }

        .question-text {
            font-size: 2.5em;
            color: #00ff88;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        .question-type {
            font-size: 1em;
            color: #aaa;
        }

        /* é€‰é¡¹åŒºåŸŸ */
        .options-area {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .option-btn {
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 10px;
            color: #fff;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-btn:hover:not(:disabled) {
            background: rgba(0, 212, 255, 0.2);
            border-color: #00d4ff;
            transform: translateY(-2px);
        }

        .option-btn.correct {
            background: rgba(0, 255, 136, 0.3);
            border-color: #00ff88;
        }

        .option-btn.wrong {
            background: rgba(255, 0, 136, 0.3);
            border-color: #ff0088;
        }

        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* ç»“æœç•Œé¢ */
        #resultScreen {
            display: none;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .result-title {
            font-size: 2em;
            color: #00d4ff;
            text-align: center;
            margin-bottom: 20px;
        }

        .result-player {
            text-align: center;
            font-size: 1.5em;
            color: #00ff88;
            margin-bottom: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-item {
            background: rgba(0, 212, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #00d4ff;
        }

        .stat-item-label {
            color: #aaa;
            margin-bottom: 10px;
        }

        .stat-item-value {
            font-size: 2em;
            color: #00ff88;
            font-weight: bold;
        }

        /* å›¾è¡¨å®¹å™¨ */
        .chart-container {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .chart-title {
            color: #00d4ff;
            margin-bottom: 15px;
            text-align: center;
        }

        .chart-canvas {
            width: 100%;
            height: 200px;
            border-radius: 5px;
        }

        /* Boss æç¤º */
        .boss-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 0, 136, 0.95);
            padding: 40px 60px;
            border-radius: 20px;
            font-size: 3em;
            font-weight: bold;
            z-index: 1000;
            animation: bossAppear 1s ease;
            display: none;
            border: 3px solid #ff0088;
            box-shadow: 0 0 50px rgba(255, 0, 136, 0.8);
        }

        @keyframes bossAppear {
            0% { transform: translate(-50%, -50%) scale(0); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .status-bar {
                grid-template-columns: repeat(2, 1fr);
            }
            .options-area {
                grid-template-columns: 1fr;
            }
            h1 {
                font-size: 1.8em;
            }
            .question-text {
                font-size: 2em;
            }
            .boss-alert {
                font-size: 2em;
                padding: 30px 40px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® ä¸­éŸ©è¯æ±‡å¡”é˜²æ¸¸æˆ | í•œì¤‘ ì–´íœ˜ íƒ€ì›Œ ë””íœìŠ¤ ğŸ®</h1>
        <p class="subtitle">å‡»è´¥æ€ªç‰©ï¼ŒæŒæ¡è¯æ±‡ï¼| ëª¬ìŠ¤í„°ë¥¼ ë¬¼ë¦¬ì¹˜ê³  ì–´íœ˜ë¥¼ ë§ˆìŠ¤í„°í•˜ì„¸ìš”!</p>

        <!-- ç™»å½•ç•Œé¢ -->
        <div id="loginScreen">
            <h2>æ¬¢è¿ | í™˜ì˜í•©ë‹ˆë‹¤</h2>
            <p>è¯·è¾“å…¥æ‚¨çš„åå­—å¼€å§‹æ¸¸æˆ<br>ì´ë¦„ì„ ì…ë ¥í•˜ì—¬ ê²Œì„ì„ ì‹œì‘í•˜ì„¸ìš”</p>
            
            <div class="input-group">
                <label for="playerNameInput">ç©å®¶åå­— | í”Œë ˆì´ì–´ ì´ë¦„</label>
                <input 
                    type="text" 
                    id="playerNameInput" 
                    placeholder="è¯·è¾“å…¥æ‚¨çš„åå­— | ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" 
                    maxlength="20"
                    autocomplete="off"
                >
            </div>
            
            <button class="btn btn-primary" onclick="login()">å¼€å§‹ | ì‹œì‘</button>
        </div>

        <!-- å¼€å§‹ç•Œé¢ -->
        <div id="startScreen">
            <div class="welcome-message">
                ğŸ‘‹ æ¬¢è¿ï¼Œ<span id="welcomeName"></span>ï¼<br>
                í™˜ì˜í•©ë‹ˆë‹¤!
            </div>
            
            <h2>æ¸¸æˆè§„åˆ™ | ê²Œì„ ê·œì¹™</h2>
            <p style="margin-bottom: 20px; line-height: 1.8; color: #ccc;">
                âœ… é€‰æ‹©æ­£ç¡®çš„è¯æ±‡ç¿»è¯‘å‡»è´¥æ€ªç‰©<br>
                âŒ ç­”é”™ä¼šè®©æ€ªç‰©åŠ é€Ÿå‰è¿›<br>
                ğŸ‘¾ æ¯10é¢˜å‡ºç°Bossæ€ªç‰©ï¼Œéœ€è¿ç»­ç­”å¯¹3æ¬¡<br>
                âš ï¸ 5åªæ€ªç‰©åˆ°è¾¾ç»ˆç‚¹ = æ¸¸æˆå¤±è´¥<br><br>
                ì •í™•í•œ ì–´íœ˜ ë²ˆì—­ì„ ì„ íƒí•˜ì—¬ ëª¬ìŠ¤í„°ë¥¼ ë¬¼ë¦¬ì¹˜ì„¸ìš”!
            </p>
            <button class="btn btn-primary" onclick="startGame()">å¼€å§‹æ¸¸æˆ | ê²Œì„ ì‹œì‘</button>
            <button class="btn btn-secondary" onclick="logout()">æ›´æ¢ç©å®¶ | í”Œë ˆì´ì–´ ë³€ê²½</button>
        </div>

        <!-- æ¸¸æˆç•Œé¢ -->
        <div id="gameScreen">
            <!-- ç©å®¶ä¿¡æ¯ -->
            <div class="player-info">
                <span>ç©å®¶ | í”Œë ˆì´ì–´: </span>
                <span class="player-name" id="playerNameDisplay"></span>
            </div>

            <!-- çŠ¶æ€æ  -->
            <div class="status-bar">
                <div class="stat-box">
                    <div class="stat-label">åˆ†æ•° | ì ìˆ˜</div>
                    <div class="stat-value" id="scoreDisplay">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">æ­£ç¡®ç‡ | ì •ë‹µë¥ </div>
                    <div class="stat-value" id="accuracyDisplay">100%</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">éš¾åº¦ç­‰çº§ | ë‚œì´ë„</div>
                    <div class="stat-value" id="difficultyDisplay">1</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">é€ƒè„±æ€ªç‰© | íƒˆì¶œ</div>
                    <div class="stat-value" id="escapedDisplay">0/5</div>
                </div>
            </div>

            <!-- æ¸¸æˆç”»å¸ƒ -->
            <canvas id="gameCanvas"></canvas>

            <!-- é¢˜ç›®åŒºåŸŸ -->
            <div class="question-area">
                <div class="question-text" id="questionText">å‡†å¤‡ä¸­...</div>
                <div class="question-type" id="questionType">è¯·é€‰æ‹©æ­£ç¡®çš„ç¿»è¯‘ | ì˜¬ë°”ë¥¸ ë²ˆì—­ì„ ì„ íƒí•˜ì„¸ìš”</div>
            </div>

            <!-- é€‰é¡¹åŒºåŸŸ -->
            <div class="options-area" id="optionsArea"></div>
        </div>

        <!-- ç»“æœç•Œé¢ -->
        <div id="resultScreen">
            <div class="result-card">
                <h2 class="result-title" id="resultTitle">æ¸¸æˆç»“æŸ | ê²Œì„ ì¢…ë£Œ</h2>
                <div class="result-player">
                    ç©å®¶ | í”Œë ˆì´ì–´: <span id="resultPlayerName"></span>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-item-label">æ€»å¾—åˆ† | ì´ì </div>
                        <div class="stat-item-value" id="finalScore">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-item-label">æ­£ç¡®ç‡ | ì •ë‹µë¥ </div>
                        <div class="stat-item-value" id="finalAccuracy">0%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-item-label">å¹³å‡ååº”æ—¶é—´ | í‰ê·  ë°˜ì‘ ì‹œê°„</div>
                        <div class="stat-item-value" id="avgReactionTime">0s</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-item-label">æœ€é«˜éš¾åº¦ | ìµœê³  ë‚œì´ë„</div>
                        <div class="stat-item-value" id="maxDifficulty">1</div>
                    </div>
                </div>

                <!-- ç»Ÿè®¡å›¾è¡¨ -->
                <div class="chart-container">
                    <h3 class="chart-title">æ­£ç¡®ç‡è¶‹åŠ¿ | ì •ë‹µë¥  ì¶”ì´</h3>
                    <canvas class="chart-canvas" id="accuracyChart"></canvas>
                </div>

                <div class="chart-container">
                    <h3 class="chart-title">éš¾åº¦å˜åŒ– | ë‚œì´ë„ ë³€í™”</h3>
                    <canvas class="chart-canvas" id="difficultyChart"></canvas>
                </div>

                <div class="chart-container">
                    <h3 class="chart-title">ååº”æ—¶é—´åˆ†å¸ƒ | ë°˜ì‘ ì‹œê°„ ë¶„í¬</h3>
                    <canvas class="chart-canvas" id="reactionChart"></canvas>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="restartGame()">å†ç©ä¸€æ¬¡ | ë‹¤ì‹œ í•˜ê¸°</button>
                    <button class="btn btn-secondary" onclick="logout()">è¿”å›ç™»å½• | ë¡œê·¸ì¸ìœ¼ë¡œ</button>
                </div>
            </div>
        </div>

        <!-- Boss æç¤º -->
        <div class="boss-alert" id="bossAlert">âš¡ BOSS å‡ºç°ï¼ âš¡</div>
    </div>

    <script>
        // ============================================
        // è¯æ±‡æ•°æ®åº“ (200+ ä¸­éŸ©è‹±è¯æ±‡)
        // ============================================
        const vocabulary = [
            // åŸºç¡€è¯æ±‡ (éš¾åº¦ 1) - 50ä¸ª
            { english: "hello", korean: "ì•ˆë…•í•˜ì„¸ìš”", chinese: "ä½ å¥½", difficulty: 1 },
            { english: "thank you", korean: "ê°ì‚¬í•©ë‹ˆë‹¤", chinese: "è°¢è°¢", difficulty: 1 },
            { english: "goodbye", korean: "ì•ˆë…•íˆ ê°€ì„¸ìš”", chinese: "å†è§", difficulty: 1 },
            { english: "yes", korean: "ë„¤", chinese: "æ˜¯", difficulty: 1 },
            { english: "no", korean: "ì•„ë‹ˆìš”", chinese: "ä¸æ˜¯", difficulty: 1 },
            { english: "water", korean: "ë¬¼", chinese: "æ°´", difficulty: 1 },
            { english: "food", korean: "ìŒì‹", chinese: "é£Ÿç‰©", difficulty: 1 },
            { english: "house", korean: "ì§‘", chinese: "æˆ¿å­", difficulty: 1 },
            { english: "school", korean: "í•™êµ", chinese: "å­¦æ ¡", difficulty: 1 },
            { english: "book", korean: "ì±…", chinese: "ä¹¦", difficulty: 1 },
            { english: "friend", korean: "ì¹œêµ¬", chinese: "æœ‹å‹", difficulty: 1 },
            { english: "family", korean: "ê°€ì¡±", chinese: "å®¶äºº", difficulty: 1 },
            { english: "mother", korean: "ì–´ë¨¸ë‹ˆ", chinese: "å¦ˆå¦ˆ", difficulty: 1 },
            { english: "father", korean: "ì•„ë²„ì§€", chinese: "çˆ¸çˆ¸", difficulty: 1 },
            { english: "teacher", korean: "ì„ ìƒë‹˜", chinese: "è€å¸ˆ", difficulty: 1 },
            { english: "student", korean: "í•™ìƒ", chinese: "å­¦ç”Ÿ", difficulty: 1 },
            { english: "time", korean: "ì‹œê°„", chinese: "æ—¶é—´", difficulty: 1 },
            { english: "today", korean: "ì˜¤ëŠ˜", chinese: "ä»Šå¤©", difficulty: 1 },
            { english: "tomorrow", korean: "ë‚´ì¼", chinese: "æ˜å¤©", difficulty: 1 },
            { english: "yesterday", korean: "ì–´ì œ", chinese: "æ˜¨å¤©", difficulty: 1 },
            { english: "morning", korean: "ì•„ì¹¨", chinese: "æ—©ä¸Š", difficulty: 1 },
            { english: "night", korean: "ë°¤", chinese: "æ™šä¸Š", difficulty: 1 },
            { english: "day", korean: "ë‚ ", chinese: "å¤©", difficulty: 1 },
            { english: "year", korean: "ë…„", chinese: "å¹´", difficulty: 1 },
            { english: "month", korean: "ì›”", chinese: "æœˆ", difficulty: 1 },
            { english: "week", korean: "ì£¼", chinese: "å‘¨", difficulty: 1 },
            { english: "love", korean: "ì‚¬ë‘", chinese: "çˆ±", difficulty: 1 },
            { english: "like", korean: "ì¢‹ì•„í•˜ë‹¤", chinese: "å–œæ¬¢", difficulty: 1 },
            { english: "hate", korean: "ì‹«ì–´í•˜ë‹¤", chinese: "è®¨åŒ", difficulty: 1 },
            { english: "want", korean: "ì›í•˜ë‹¤", chinese: "æƒ³è¦", difficulty: 1 },
            { english: "need", korean: "í•„ìš”í•˜ë‹¤", chinese: "éœ€è¦", difficulty: 1 },
            { english: "have", korean: "ìˆë‹¤", chinese: "æœ‰", difficulty: 1 },
            { english: "eat", korean: "ë¨¹ë‹¤", chinese: "åƒ", difficulty: 1 },
            { english: "drink", korean: "ë§ˆì‹œë‹¤", chinese: "å–", difficulty: 1 },
            { english: "sleep", korean: "ìë‹¤", chinese: "ç¡è§‰", difficulty: 1 },
            { english: "walk", korean: "ê±·ë‹¤", chinese: "èµ°", difficulty: 1 },
            { english: "run", korean: "ë‹¬ë¦¬ë‹¤", chinese: "è·‘", difficulty: 1 },
            { english: "sit", korean: "ì•‰ë‹¤", chinese: "å", difficulty: 1 },
            { english: "stand", korean: "ì„œë‹¤", chinese: "ç«™", difficulty: 1 },
            { english: "come", korean: "ì˜¤ë‹¤", chinese: "æ¥", difficulty: 1 },
            { english: "go", korean: "ê°€ë‹¤", chinese: "å»", difficulty: 1 },
            { english: "see", korean: "ë³´ë‹¤", chinese: "çœ‹", difficulty: 1 },
            { english: "hear", korean: "ë“£ë‹¤", chinese: "å¬", difficulty: 1 },
            { english: "speak", korean: "ë§í•˜ë‹¤", chinese: "è¯´", difficulty: 1 },
            { english: "read", korean: "ì½ë‹¤", chinese: "è¯»", difficulty: 1 },
            { english: "write", korean: "ì“°ë‹¤", chinese: "å†™", difficulty: 1 },
            { english: "study", korean: "ê³µë¶€í•˜ë‹¤", chinese: "å­¦ä¹ ", difficulty: 1 },
            { english: "work", korean: "ì¼í•˜ë‹¤", chinese: "å·¥ä½œ", difficulty: 1 },
            { english: "play", korean: "ë†€ë‹¤", chinese: "ç©", difficulty: 1 },
            { english: "buy", korean: "ì‚¬ë‹¤", chinese: "ä¹°", difficulty: 1 },

            // ä¸­çº§è¯æ±‡ (éš¾åº¦ 2) - 60ä¸ª
            { english: "language", korean: "ì–¸ì–´", chinese: "è¯­è¨€", difficulty: 2 },
            { english: "culture", korean: "ë¬¸í™”", chinese: "æ–‡åŒ–", difficulty: 2 },
            { english: "history", korean: "ì—­ì‚¬", chinese: "å†å²", difficulty: 2 },
            { english: "future", korean: "ë¯¸ë˜", chinese: "æœªæ¥", difficulty: 2 },
            { english: "past", korean: "ê³¼ê±°", chinese: "è¿‡å»", difficulty: 2 },
            { english: "present", korean: "í˜„ì¬", chinese: "ç°åœ¨", difficulty: 2 },
            { english: "country", korean: "ë‚˜ë¼", chinese: "å›½å®¶", difficulty: 2 },
            { english: "city", korean: "ë„ì‹œ", chinese: "åŸå¸‚", difficulty: 2 },
            { english: "village", korean: "ë§ˆì„", chinese: "æ‘åº„", difficulty: 2 },
            { english: "mountain", korean: "ì‚°", chinese: "å±±", difficulty: 2 },
            { english: "river", korean: "ê°•", chinese: "æ²³", difficulty: 2 },
            { english: "ocean", korean: "ë°”ë‹¤", chinese: "æµ·æ´‹", difficulty: 2 },
            { english: "weather", korean: "ë‚ ì”¨", chinese: "å¤©æ°”", difficulty: 2 },
            { english: "rain", korean: "ë¹„", chinese: "é›¨", difficulty: 2 },
            { english: "snow", korean: "ëˆˆ", chinese: "é›ª", difficulty: 2 },
            { english: "wind", korean: "ë°”ëŒ", chinese: "é£", difficulty: 2 },
            { english: "sun", korean: "í•´", chinese: "å¤ªé˜³", difficulty: 2 },
            { english: "moon", korean: "ë‹¬", chinese: "æœˆäº®", difficulty: 2 },
            { english: "star", korean: "ë³„", chinese: "æ˜Ÿæ˜Ÿ", difficulty: 2 },
            { english: "flower", korean: "ê½ƒ", chinese: "èŠ±", difficulty: 2 },
            { english: "tree", korean: "ë‚˜ë¬´", chinese: "æ ‘", difficulty: 2 },
            { english: "animal", korean: "ë™ë¬¼", chinese: "åŠ¨ç‰©", difficulty: 2 },
            { english: "bird", korean: "ìƒˆ", chinese: "é¸Ÿ", difficulty: 2 },
            { english: "fish", korean: "ë¬¼ê³ ê¸°", chinese: "é±¼", difficulty: 2 },
            { english: "dog", korean: "ê°œ", chinese: "ç‹—", difficulty: 2 },
            { english: "cat", korean: "ê³ ì–‘ì´", chinese: "çŒ«", difficulty: 2 },
            { english: "color", korean: "ìƒ‰ê¹”", chinese: "é¢œè‰²", difficulty: 2 },
            { english: "red", korean: "ë¹¨ê°„ìƒ‰", chinese: "çº¢è‰²", difficulty: 2 },
            { english: "blue", korean: "íŒŒë€ìƒ‰", chinese: "è“è‰²", difficulty: 2 },
            { english: "yellow", korean: "ë…¸ë€ìƒ‰", chinese: "é»„è‰²", difficulty: 2 },
            { english: "green", korean: "ì´ˆë¡ìƒ‰", chinese: "ç»¿è‰²", difficulty: 2 },
            { english: "white", korean: "í•˜ì–€ìƒ‰", chinese: "ç™½è‰²", difficulty: 2 },
            { english: "black", korean: "ê²€ì€ìƒ‰", chinese: "é»‘è‰²", difficulty: 2 },
            { english: "number", korean: "ìˆ«ì", chinese: "æ•°å­—", difficulty: 2 },
            { english: "one", korean: "í•˜ë‚˜", chinese: "ä¸€", difficulty: 2 },
            { english: "two", korean: "ë‘˜", chinese: "äºŒ", difficulty: 2 },
            { english: "three", korean: "ì…‹", chinese: "ä¸‰", difficulty: 2 },
            { english: "four", korean: "ë„·", chinese: "å››", difficulty: 2 },
            { english: "five", korean: "ë‹¤ì„¯", chinese: "äº”", difficulty: 2 },
            { english: "big", korean: "í¬ë‹¤", chinese: "å¤§", difficulty: 2 },
            { english: "small", korean: "ì‘ë‹¤", chinese: "å°", difficulty: 2 },
            { english: "long", korean: "ê¸¸ë‹¤", chinese: "é•¿", difficulty: 2 },
            { english: "short", korean: "ì§§ë‹¤", chinese: "çŸ­", difficulty: 2 },
            { english: "tall", korean: "ë†’ë‹¤", chinese: "é«˜", difficulty: 2 },
            { english: "low", korean: "ë‚®ë‹¤", chinese: "ä½", difficulty: 2 },
            { english: "hot", korean: "ëœ¨ê²ë‹¤", chinese: "çƒ­", difficulty: 2 },
            { english: "cold", korean: "ì¶¥ë‹¤", chinese: "å†·", difficulty: 2 },
            { english: "warm", korean: "ë”°ëœ»í•˜ë‹¤", chinese: "æ¸©æš–", difficulty: 2 },
            { english: "cool", korean: "ì‹œì›í•˜ë‹¤", chinese: "å‡‰çˆ½", difficulty: 2 },
            { english: "beautiful", korean: "ì•„ë¦„ë‹µë‹¤", chinese: "ç¾ä¸½", difficulty: 2 },
            { english: "ugly", korean: "ëª»ìƒê¸°ë‹¤", chinese: "ä¸‘", difficulty: 2 },
            { english: "good", korean: "ì¢‹ë‹¤", chinese: "å¥½", difficulty: 2 },
            { english: "bad", korean: "ë‚˜ì˜ë‹¤", chinese: "å", difficulty: 2 },
            { english: "happy", korean: "í–‰ë³µí•˜ë‹¤", chinese: "å¹¸ç¦", difficulty: 2 },
            { english: "sad", korean: "ìŠ¬í”„ë‹¤", chinese: "æ‚²ä¼¤", difficulty: 2 },
            { english: "angry", korean: "í™”ë‚˜ë‹¤", chinese: "ç”Ÿæ°”", difficulty: 2 },
            { english: "tired", korean: "í”¼ê³¤í•˜ë‹¤", chinese: "ç´¯", difficulty: 2 },
            { english: "hungry", korean: "ë°°ê³ í”„ë‹¤", chinese: "é¥¿", difficulty: 2 },
            { english: "thirsty", korean: "ëª©ë§ˆë¥´ë‹¤", chinese: "æ¸´", difficulty: 2 },
            { english: "sick", korean: "ì•„í”„ë‹¤", chinese: "ç”Ÿç—…", difficulty: 2 },

            // é«˜çº§è¯æ±‡ (éš¾åº¦ 3) - 100ä¸ª
            { english: "economy", korean: "ê²½ì œ", chinese: "ç»æµ", difficulty: 3 },
            { english: "politics", korean: "ì •ì¹˜", chinese: "æ”¿æ²»", difficulty: 3 },
            { english: "society", korean: "ì‚¬íšŒ", chinese: "ç¤¾ä¼š", difficulty: 3 },
            { english: "technology", korean: "ê¸°ìˆ ", chinese: "æŠ€æœ¯", difficulty: 3 },
            { english: "science", korean: "ê³¼í•™", chinese: "ç§‘å­¦", difficulty: 3 },
            { english: "education", korean: "êµìœ¡", chinese: "æ•™è‚²", difficulty: 3 },
            { english: "environment", korean: "í™˜ê²½", chinese: "ç¯å¢ƒ", difficulty: 3 },
            { english: "development", korean: "ë°œì „", chinese: "å‘å±•", difficulty: 3 },
            { english: "problem", korean: "ë¬¸ì œ", chinese: "é—®é¢˜", difficulty: 3 },
            { english: "solution", korean: "í•´ê²°ì±…", chinese: "è§£å†³æ–¹æ¡ˆ", difficulty: 3 },
            { english: "opportunity", korean: "ê¸°íšŒ", chinese: "æœºä¼š", difficulty: 3 },
            { english: "challenge", korean: "ë„ì „", chinese: "æŒ‘æˆ˜", difficulty: 3 },
            { english: "success", korean: "ì„±ê³µ", chinese: "æˆåŠŸ", difficulty: 3 },
            { english: "failure", korean: "ì‹¤íŒ¨", chinese: "å¤±è´¥", difficulty: 3 },
            { english: "experience", korean: "ê²½í—˜", chinese: "ç»éªŒ", difficulty: 3 },
            { english: "knowledge", korean: "ì§€ì‹", chinese: "çŸ¥è¯†", difficulty: 3 },
            { english: "wisdom", korean: "ì§€í˜œ", chinese: "æ™ºæ…§", difficulty: 3 },
            { english: "ability", korean: "ëŠ¥ë ¥", chinese: "èƒ½åŠ›", difficulty: 3 },
            { english: "skill", korean: "ê¸°ìˆ ", chinese: "æŠ€èƒ½", difficulty: 3 },
            { english: "talent", korean: "ì¬ëŠ¥", chinese: "æ‰èƒ½", difficulty: 3 },
            { english: "effort", korean: "ë…¸ë ¥", chinese: "åŠªåŠ›", difficulty: 3 },
            { english: "achievement", korean: "ì„±ì·¨", chinese: "æˆå°±", difficulty: 3 },
            { english: "goal", korean: "ëª©í‘œ", chinese: "ç›®æ ‡", difficulty: 3 },
            { english: "dream", korean: "ê¿ˆ", chinese: "æ¢¦æƒ³", difficulty: 3 },
            { english: "hope", korean: "í¬ë§", chinese: "å¸Œæœ›", difficulty: 3 },
            { english: "courage", korean: "ìš©ê¸°", chinese: "å‹‡æ°”", difficulty: 3 },
            { english: "confidence", korean: "ìì‹ ê°", chinese: "è‡ªä¿¡", difficulty: 3 },
            { english: "patience", korean: "ì¸ë‚´", chinese: "è€å¿ƒ", difficulty: 3 },
            { english: "honesty", korean: "ì •ì§", chinese: "è¯šå®", difficulty: 3 },
            { english: "kindness", korean: "ì¹œì ˆ", chinese: "å–„è‰¯", difficulty: 3 },
            { english: "respect", korean: "ì¡´ì¤‘", chinese: "å°Šé‡", difficulty: 3 },
            { english: "responsibility", korean: "ì±…ì„", chinese: "è´£ä»»", difficulty: 3 },
            { english: "freedom", korean: "ììœ ", chinese: "è‡ªç”±", difficulty: 3 },
            { english: "peace", korean: "í‰í™”", chinese: "å’Œå¹³", difficulty: 3 },
            { english: "justice", korean: "ì •ì˜", chinese: "æ­£ä¹‰", difficulty: 3 },
            { english: "equality", korean: "í‰ë“±", chinese: "å¹³ç­‰", difficulty: 3 },
            { english: "democracy", korean: "ë¯¼ì£¼ì£¼ì˜", chinese: "æ°‘ä¸»", difficulty: 3 },
            { english: "tradition", korean: "ì „í†µ", chinese: "ä¼ ç»Ÿ", difficulty: 3 },
            { english: "innovation", korean: "í˜ì‹ ", chinese: "åˆ›æ–°", difficulty: 3 },
            { english: "cooperation", korean: "í˜‘ë ¥", chinese: "åˆä½œ", difficulty: 3 },
            { english: "competition", korean: "ê²½ìŸ", chinese: "ç«äº‰", difficulty: 3 },
            { english: "communication", korean: "ì†Œí†µ", chinese: "æ²Ÿé€š", difficulty: 3 },
            { english: "understanding", korean: "ì´í•´", chinese: "ç†è§£", difficulty: 3 },
            { english: "relationship", korean: "ê´€ê³„", chinese: "å…³ç³»", difficulty: 3 },
            { english: "emotion", korean: "ê°ì •", chinese: "æƒ…æ„Ÿ", difficulty: 3 },
            { english: "thought", korean: "ìƒê°", chinese: "æ€æƒ³", difficulty: 3 },
            { english: "memory", korean: "ê¸°ì–µ", chinese: "è®°å¿†", difficulty: 3 },
            { english: "imagination", korean: "ìƒìƒë ¥", chinese: "æƒ³è±¡åŠ›", difficulty: 3 },
            { english: "creativity", korean: "ì°½ì˜ì„±", chinese: "åˆ›é€ åŠ›", difficulty: 3 },
            { english: "curiosity", korean: "í˜¸ê¸°ì‹¬", chinese: "å¥½å¥‡å¿ƒ", difficulty: 3 },
            { english: "motivation", korean: "ë™ê¸°", chinese: "åŠ¨æœº", difficulty: 3 },
            { english: "determination", korean: "ê²°ë‹¨ë ¥", chinese: "å†³å¿ƒ", difficulty: 3 },
            { english: "perseverance", korean: "ì¸ë‚´ë ¥", chinese: "æ¯…åŠ›", difficulty: 3 },
            { english: "adaptability", korean: "ì ì‘ë ¥", chinese: "é€‚åº”èƒ½åŠ›", difficulty: 3 },
            { english: "flexibility", korean: "ìœ ì—°ì„±", chinese: "çµæ´»æ€§", difficulty: 3 },
            { english: "efficiency", korean: "íš¨ìœ¨ì„±", chinese: "æ•ˆç‡", difficulty: 3 },
            { english: "productivity", korean: "ìƒì‚°ì„±", chinese: "ç”Ÿäº§åŠ›", difficulty: 3 },
            { english: "quality", korean: "í’ˆì§ˆ", chinese: "è´¨é‡", difficulty: 3 },
            { english: "quantity", korean: "ìˆ˜ëŸ‰", chinese: "æ•°é‡", difficulty: 3 },
            { english: "balance", korean: "ê· í˜•", chinese: "å¹³è¡¡", difficulty: 3 },
            { english: "harmony", korean: "ì¡°í™”", chinese: "å’Œè°", difficulty: 3 },
            { english: "diversity", korean: "ë‹¤ì–‘ì„±", chinese: "å¤šæ ·æ€§", difficulty: 3 },
            { english: "similarity", korean: "ìœ ì‚¬ì„±", chinese: "ç›¸ä¼¼æ€§", difficulty: 3 },
            { english: "difference", korean: "ì°¨ì´", chinese: "å·®å¼‚", difficulty: 3 },
            { english: "advantage", korean: "ì¥ì ", chinese: "ä¼˜åŠ¿", difficulty: 3 },
            { english: "disadvantage", korean: "ë‹¨ì ", chinese: "åŠ£åŠ¿", difficulty: 3 },
            { english: "strength", korean: "ê°•ì ", chinese: "å¼ºé¡¹", difficulty: 3 },
            { english: "weakness", korean: "ì•½ì ", chinese: "å¼±ç‚¹", difficulty: 3 },
            { english: "possibility", korean: "ê°€ëŠ¥ì„±", chinese: "å¯èƒ½æ€§", difficulty: 3 },
            { english: "probability", korean: "í™•ë¥ ", chinese: "æ¦‚ç‡", difficulty: 3 },
            { english: "necessity", korean: "í•„ìš”ì„±", chinese: "å¿…è¦æ€§", difficulty: 3 },
            { english: "importance", korean: "ì¤‘ìš”ì„±", chinese: "é‡è¦æ€§", difficulty: 3 },
            { english: "significance", korean: "ì˜ì˜", chinese: "æ„ä¹‰", difficulty: 3 },
            { english: "influence", korean: "ì˜í–¥", chinese: "å½±å“", difficulty: 3 },
            { english: "impact", korean: "ì˜í–¥ë ¥", chinese: "å†²å‡»", difficulty: 3 },
            { english: "consequence", korean: "ê²°ê³¼", chinese: "åæœ", difficulty: 3 },
            { english: "reason", korean: "ì´ìœ ", chinese: "åŸå› ", difficulty: 3 },
            { english: "cause", korean: "ì›ì¸", chinese: "èµ·å› ", difficulty: 3 },
            { english: "effect", korean: "íš¨ê³¼", chinese: "æ•ˆæœ", difficulty: 3 },
            { english: "purpose", korean: "ëª©ì ", chinese: "ç›®çš„", difficulty: 3 },
            { english: "method", korean: "ë°©ë²•", chinese: "æ–¹æ³•", difficulty: 3 },
            { english: "process", korean: "ê³¼ì •", chinese: "è¿‡ç¨‹", difficulty: 3 },
            { english: "result", korean: "ê²°ê³¼", chinese: "ç»“æœ", difficulty: 3 },
            { english: "conclusion", korean: "ê²°ë¡ ", chinese: "ç»“è®º", difficulty: 3 },
            { english: "beginning", korean: "ì‹œì‘", chinese: "å¼€å§‹", difficulty: 3 },
            { english: "end", korean: "ë", chinese: "ç»“æŸ", difficulty: 3 },
            { english: "middle", korean: "ì¤‘ê°„", chinese: "ä¸­é—´", difficulty: 3 },
            { english: "whole", korean: "ì „ì²´", chinese: "æ•´ä½“", difficulty: 3 },
            { english: "part", korean: "ë¶€ë¶„", chinese: "éƒ¨åˆ†", difficulty: 3 },
            { english: "detail", korean: "ì„¸ë¶€ì‚¬í•­", chinese: "ç»†èŠ‚", difficulty: 3 },
            { english: "summary", korean: "ìš”ì•½", chinese: "æ€»ç»“", difficulty: 3 },
            { english: "explanation", korean: "ì„¤ëª…", chinese: "è§£é‡Š", difficulty: 3 },
            { english: "description", korean: "ë¬˜ì‚¬", chinese: "æè¿°", difficulty: 3 },
            { english: "definition", korean: "ì •ì˜", chinese: "å®šä¹‰", difficulty: 3 },
            { english: "example", korean: "ì˜ˆ", chinese: "ä¾‹å­", difficulty: 3 },
            { english: "theory", korean: "ì´ë¡ ", chinese: "ç†è®º", difficulty: 3 },
            { english: "practice", korean: "ì‹¤ì²œ", chinese: "å®è·µ", difficulty: 3 },
            { english: "reality", korean: "í˜„ì‹¤", chinese: "ç°å®", difficulty: 3 },
            { english: "ideal", korean: "ì´ìƒ", chinese: "ç†æƒ³", difficulty: 3 },
        ];

        // ============================================
        // æ¸¸æˆçŠ¶æ€å˜é‡
        // ============================================
        let playerName = '';
        let canvas, ctx;
        let score = 0;
        let correctAnswers = 0;
        let totalQuestions = 0;
        let difficultyLevel = 1;
        let escapedMonsters = 0;
        let maxEscaped = 5;
        let questionStartTime = 0;
        let reactionTimes = [];
        let correctHistory = [];
        let difficultyHistory = [];
        let monsters = [];
        let bullets = [];
        let currentQuestion = null;
        let gameRunning = false;
        let questionNumber = 0;
        let consecutiveCorrect = 0;
        let consecutiveWrong = 0;
        let isBossRound = false;
        let bossHitsNeeded = 3;
        let bossHits = 0;

        // ============================================
        // ç™»å½•åŠŸèƒ½
        // ============================================
        function login() {
            const nameInput = document.getElementById('playerNameInput');
            const name = nameInput.value.trim();
            
            if (name === '') {
                alert('è¯·è¾“å…¥æ‚¨çš„åå­—ï¼\nì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                nameInput.focus();
                return;
            }
            
            playerName = name;
            
            // åˆ‡æ¢ç•Œé¢
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';
            document.getElementById('welcomeName').textContent = playerName;
        }

        // ç›‘å¬Enteré”®
        window.addEventListener('DOMContentLoaded', function() {
            const nameInput = document.getElementById('playerNameInput');
            if (nameInput) {
                nameInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        login();
                    }
                });
                nameInput.focus();
            }
        });

        // ============================================
        // ç™»å‡ºåŠŸèƒ½
        // ============================================
        function logout() {
            playerName = '';
            document.getElementById('playerNameInput').value = '';
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'block';
            
            setTimeout(() => {
                document.getElementById('playerNameInput').focus();
            }, 100);
        }

        // ============================================
        // æ€ªç‰©ç±»
        // ============================================
        class Monster {
            constructor(isBoss = false) {
                this.x = canvas.width;
                this.y = Math.random() * (canvas.height - 60) + 30;
                this.speed = isBoss ? 0.5 : 1 + Math.random() * 0.5;
                this.health = isBoss ? 100 : 50;
                this.maxHealth = this.health;
                this.isBoss = isBoss;
                this.size = isBoss ? 50 : 30;
                this.color = isBoss ? '#ff0088' : '#ff4444';
            }

            update() {
                this.x -= this.speed;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();

                ctx.fillStyle = '#fff';
                ctx.beginPath();
                ctx.arc(this.x - 10, this.y - 5, 5, 0, Math.PI * 2);
                ctx.arc(this.x + 10, this.y - 5, 5, 0, Math.PI * 2);
                ctx.fill();

                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(this.x - 10, this.y - 5, 2, 0, Math.PI * 2);
                ctx.arc(this.x + 10, this.y - 5, 2, 0, Math.PI * 2);
                ctx.fill();

                const barWidth = this.size * 2;
                const barHeight = 5;
                const healthPercent = this.health / this.maxHealth;
                
                ctx.fillStyle = '#333';
                ctx.fillRect(this.x - barWidth / 2, this.y - this.size - 10, barWidth, barHeight);
                
                ctx.fillStyle = this.isBoss ? '#ff00ff' : '#00ff00';
                ctx.fillRect(this.x - barWidth / 2, this.y - this.size - 10, barWidth * healthPercent, barHeight);

                if (this.isBoss) {
                    ctx.fillStyle = '#ffff00';
                    ctx.font = 'bold 12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('BOSS', this.x, this.y - this.size - 15);
                }
            }

            takeDamage(damage) {
                this.health -= damage;
                return this.health <= 0;
            }

            speedUp() {
                this.speed *= 1.5;
            }
        }

        // ============================================
        // å­å¼¹ç±»
        // ============================================
        class Bullet {
            constructor(targetX, targetY) {
                this.x = 50;
                this.y = canvas.height / 2;
                this.targetX = targetX;
                this.targetY = targetY;
                this.speed = 8;
                const angle = Math.atan2(targetY - this.y, targetX - this.x);
                this.vx = Math.cos(angle) * this.speed;
                this.vy = Math.sin(angle) * this.speed;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
            }

            draw() {
                ctx.fillStyle = '#00ff88';
                ctx.shadowBlur = 10;
                ctx.shadowColor = '#00ff88';
                ctx.beginPath();
                ctx.arc(this.x, this.y, 5, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0;
            }

            isOffScreen() {
                return this.x > canvas.width || this.x < 0 || this.y > canvas.height || this.y < 0;
            }
        }

        // ============================================
        // æ¸¸æˆåˆå§‹åŒ–
        // ============================================
        function initGame() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            canvas.width = canvas.offsetWidth;
            canvas.height = 400;

            window.addEventListener('resize', () => {
                if (canvas && gameRunning) {
                    const oldWidth = canvas.width;
                    canvas.width = canvas.offsetWidth;
                    canvas.height = 400;
                    
                    // è°ƒæ•´æ€ªç‰©ä½ç½®
                    const ratio = canvas.width / oldWidth;
                    monsters.forEach(m => m.x *= ratio);
                    bullets.forEach(b => {
                        b.x *= ratio;
                        b.targetX *= ratio;
                    });
                }
            });
        }

        // ============================================
        // å¼€å§‹æ¸¸æˆ
        // ============================================
        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            
            document.getElementById('playerNameDisplay').textContent = playerName;
            
            // é‡ç½®å˜é‡
            score = 0;
            correctAnswers = 0;
            totalQuestions = 0;
            difficultyLevel = 1;
            escapedMonsters = 0;
            reactionTimes = [];
            correctHistory = [];
            difficultyHistory = [];
            monsters = [];
            bullets = [];
            questionNumber = 0;
            consecutiveCorrect = 0;
            consecutiveWrong = 0;
            gameRunning = true;

            initGame();
            spawnMonster();
            generateQuestion();
            gameLoop();
        }

        // ============================================
        // ç”Ÿæˆæ€ªç‰©
        // ============================================
        function spawnMonster() {
            questionNumber++;
            isBossRound = questionNumber % 10 === 0;
            
            if (isBossRound) {
                showBossAlert();
                bossHits = 0;
                monsters.push(new Monster(true));
            } else {
                monsters.push(new Monster(false));
            }
        }

        // ============================================
        // æ˜¾ç¤ºBossæç¤º
        // ============================================
        function showBossAlert() {
            const alert = document.getElementById('bossAlert');
            alert.style.display = 'block';
            setTimeout(() => {
                alert.style.display = 'none';
            }, 2000);
        }

        // ============================================
        // ç”Ÿæˆé—®é¢˜
        // ============================================
        function generateQuestion() {
            questionStartTime = Date.now();
            
            const availableWords = vocabulary.filter(word => word.difficulty === difficultyLevel);
            const wordPool = availableWords.length > 0 ? availableWords : vocabulary;
            const correctWord = wordPool[Math.floor(Math.random() * wordPool.length)];
            
            const options = [correctWord];
            while (options.length < 4) {
                const randomWord = vocabulary[Math.floor(Math.random() * vocabulary.length)];
                if (!options.includes(randomWord)) {
                    options.push(randomWord);
                }
            }
            
            options.sort(() => Math.random() - 0.5);
            
            currentQuestion = {
                correct: correctWord,
                options: options
            };
            
            document.getElementById('questionText').textContent = correctWord.korean;
            
            if (isBossRound) {
                document.getElementById('questionType').textContent = 
                    `âš¡ BOSSæˆ˜ï¼éœ€è¿ç»­ç­”å¯¹${bossHitsNeeded}æ¬¡ | BOSSì „! ${bossHitsNeeded}ë²ˆ ì—°ì† ì •ë‹µ í•„ìš”`;
            } else {
                document.getElementById('questionType').textContent = 
                    'è¯·é€‰æ‹©æ­£ç¡®çš„ç¿»è¯‘ | ì˜¬ë°”ë¥¸ ë²ˆì—­ì„ ì„ íƒí•˜ì„¸ìš”';
            }
            
            const optionsArea = document.getElementById('optionsArea');
            optionsArea.innerHTML = '';
            
            options.forEach((option) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerHTML = `
                    <div style="font-size: 1.1em; margin-bottom: 5px;">${option.chinese}</div>
                    <div style="font-size: 0.9em; color: #aaa;">${option.english}</div>
                `;
                btn.onclick = () => checkAnswer(option, btn);
                optionsArea.appendChild(btn);
            });
        }

        // ============================================
        // æ£€æŸ¥ç­”æ¡ˆ
        // ============================================
        function checkAnswer(selectedWord, button) {
            const reactionTime = (Date.now() - questionStartTime) / 1000;
            reactionTimes.push(reactionTime);
            totalQuestions++;
            
            const isCorrect = selectedWord === currentQuestion.correct;
            
            const allButtons = document.querySelectorAll('.option-btn');
            allButtons.forEach(btn => btn.disabled = true);
            
            if (isCorrect) {
                correctAnswers++;
                score += 10 * difficultyLevel;
                consecutiveCorrect++;
                consecutiveWrong = 0;
                button.classList.add('correct');
                
                if (isBossRound) {
                    bossHits++;
                    if (bossHits >= bossHitsNeeded) {
                        shootBullet();
                    } else {
                        setTimeout(() => {
                            generateQuestion();
                        }, 800);
                        return;
                    }
                } else {
                    shootBullet();
                }
                
                if (consecutiveCorrect >= 3 && difficultyLevel < 3) {
                    difficultyLevel++;
                    consecutiveCorrect = 0;
                }
                
                correctHistory.push(1);
                
            } else {
                consecutiveWrong++;
                consecutiveCorrect = 0;
                button.classList.add('wrong');
                
                allButtons.forEach(btn => {
                    const btnText = btn.querySelector('div').textContent;
                    if (btnText === currentQuestion.correct.chinese) {
                        btn.classList.add('correct');
                    }
                });
                
                monsters.forEach(monster => monster.speedUp());
                
                if (consecutiveWrong >= 2 && difficultyLevel > 1) {
                    difficultyLevel--;
                    consecutiveWrong = 0;
                }
                
                correctHistory.push(0);
            }
            
            difficultyHistory.push(difficultyLevel);
            updateUI();
            
            setTimeout(() => {
                if (!isBossRound || bossHits >= bossHitsNeeded) {
                    spawnMonster();
                }
                generateQuestion();
            }, 1000);
        }

        // ============================================
        // å‘å°„å­å¼¹
        // ============================================
        function shootBullet() {
            if (monsters.length > 0) {
                const target = monsters[0];
                bullets.push(new Bullet(target.x, target.y));
            }
        }

        // ============================================
        // æ›´æ–°UI
        // ============================================
        function updateUI() {
            document.getElementById('scoreDisplay').textContent = score;
            
            const accuracy = totalQuestions > 0 ? 
                ((correctAnswers / totalQuestions) * 100).toFixed(1) : 100;
            document.getElementById('accuracyDisplay').textContent = accuracy + '%';
            
            document.getElementById('difficultyDisplay').textContent = difficultyLevel;
            document.getElementById('escapedDisplay').textContent = `${escapedMonsters}/${maxEscaped}`;
        }

        // ============================================
        // æ¸¸æˆä¸»å¾ªç¯
        // ============================================
        function gameLoop() {
            if (!gameRunning) return;
            
            ctx.fillStyle = 'rgba(15, 12, 41, 0.3)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#00d4ff';
            ctx.fillRect(20, canvas.height / 2 - 30, 60, 60);
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 30px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ğŸ°', 50, canvas.height / 2 + 10);
            
            for (let i = monsters.length - 1; i >= 0; i--) {
                const monster = monsters[i];
                monster.update();
                monster.draw();
                
                if (monster.x + monster.size < 0) {
                    monsters.splice(i, 1);
                    escapedMonsters++;
                    
                    if (escapedMonsters >= maxEscaped) {
                        endGame(false);
                        return;
                    }
                    updateUI();
                }
            }
            
            for (let i = bullets.length - 1; i >= 0; i--) {
                const bullet = bullets[i];
                bullet.update();
                bullet.draw();
                
                for (let j = monsters.length - 1; j >= 0; j--) {
                    const monster = monsters[j];
                    const dx = bullet.x - monster.x;
                    const dy = bullet.y - monster.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < monster.size) {
                        bullets.splice(i, 1);
                        if (monster.takeDamage(50)) {
                            monsters.splice(j, 1);
                        }
                        break;
                    }
                }
                
                if (bullet.isOffScreen()) {
                    bullets.splice(i, 1);
                }
            }
            
            requestAnimationFrame(gameLoop);
        }

        // ============================================
        // ç»“æŸæ¸¸æˆ
        // ============================================
        function endGame(victory) {
            gameRunning = false;
            
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'block';
            
            document.getElementById('resultPlayerName').textContent = playerName;
            
            if (victory) {
                document.getElementById('resultTitle').textContent = 'ğŸ‰ èƒœåˆ©ï¼ | ìŠ¹ë¦¬! ğŸ‰';
                document.getElementById('resultTitle').style.color = '#00ff88';
            } else {
                document.getElementById('resultTitle').textContent = 'ğŸ˜¢ å¤±è´¥ | ì‹¤íŒ¨ ğŸ˜¢';
                document.getElementById('resultTitle').style.color = '#ff0088';
            }
            
            const accuracy = totalQuestions > 0 ? 
                ((correctAnswers / totalQuestions) * 100).toFixed(1) : 0;
            
            const avgReactionTime = reactionTimes.length > 0 ?
                (reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length).toFixed(2) : 0;
            
            const maxDifficulty = difficultyHistory.length > 0 ? Math.max(...difficultyHistory) : 1;
            
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalAccuracy').textContent = accuracy + '%';
            document.getElementById('avgReactionTime').textContent = avgReactionTime + 's';
            document.getElementById('maxDifficulty').textContent = maxDifficulty;
            
            drawAccuracyChart();
            drawDifficultyChart();
            drawReactionChart();
        }

        // ============================================
        // ç»˜åˆ¶æ­£ç¡®ç‡è¶‹åŠ¿å›¾
        // ============================================
        function drawAccuracyChart() {
            const canvas = document.getElementById('accuracyChart');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = 200;
            
            const padding = 40;
            const width = canvas.width - padding * 2;
            const height = canvas.height - padding * 2;
            
            const accuracyData = [];
            let correct = 0;
            for (let i = 0; i < correctHistory.length; i++) {
                correct += correctHistory[i];
                accuracyData.push((correct / (i + 1)) * 100);
            }
            
            if (accuracyData.length === 0) return;
            
            const n = accuracyData.length;
            let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0;
            
            for (let i = 0; i < n; i++) {
                sumX += i;
                sumY += accuracyData[i];
                sumXY += i * accuracyData[i];
                sumX2 += i * i;
            }
            
            const m = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
            const b = (sumY - m * sumX) / n;
            
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.strokeStyle = '#555';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();
            
            ctx.strokeStyle = '#00d4ff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            for (let i = 0; i < accuracyData.length; i++) {
                const x = padding + (i / (accuracyData.length - 1)) * width;
                const y = canvas.height - padding - (accuracyData[i] / 100) * height;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
                
                ctx.fillStyle = '#00ff88';
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.stroke();
            
            ctx.strokeStyle = '#ff0088';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            
            const startY = canvas.height - padding - (b / 100) * height;
            const endY = canvas.height - padding - ((m * (n - 1) + b) / 100) * height;
            
            ctx.moveTo(padding, startY);
            ctx.lineTo(canvas.width - padding, endY);
            ctx.stroke();
            ctx.setLineDash([]);
            
            ctx.fillStyle = '#fff';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('é¢˜å· | ë¬¸ì œ ë²ˆí˜¸', canvas.width / 2, canvas.height - 10);
            
            ctx.save();
            ctx.translate(15, canvas.height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('æ­£ç¡®ç‡% | ì •ë‹µë¥ %', 0, 0);
            ctx.restore();
        }

        // ============================================
        // ç»˜åˆ¶éš¾åº¦å˜åŒ–å›¾
        // ============================================
        function drawDifficultyChart() {
            const canvas = document.getElementById('difficultyChart');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = 200;
            
            const padding = 40;
            const width = canvas.width - padding * 2;
            const height = canvas.height - padding * 2;
            
            if (difficultyHistory.length === 0) return;
            
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.strokeStyle = '#555';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();
            
            ctx.strokeStyle = '#00ff88';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let i = 0; i < difficultyHistory.length; i++) {
                const x = padding + (i / Math.max(1, difficultyHistory.length - 1)) * width;
                const y = canvas.height - padding - ((difficultyHistory[i] - 1) / 2) * height;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            ctx.fillStyle = '#fff';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('IRTéš¾åº¦è‡ªé€‚åº” | IRT ë‚œì´ë„ ì ì‘', canvas.width / 2, canvas.height - 10);
        }

        // ============================================
        // ç»˜åˆ¶ååº”æ—¶é—´åˆ†å¸ƒå›¾
        // ============================================
        function drawReactionChart() {
            const canvas = document.getElementById('reactionChart');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = 200;
            
            const padding = 40;
            const width = canvas.width - padding * 2;
            const height = canvas.height - padding * 2;
            
            if (reactionTimes.length === 0) return;
            
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.strokeStyle = '#555';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();
            
            const maxTime = Math.max(...reactionTimes);
            const barWidth = width / reactionTimes.length;
            
            for (let i = 0; i < reactionTimes.length; i++) {
                const barHeight = (reactionTimes[i] / maxTime) * height;
                const x = padding + i * barWidth;
                const y = canvas.height - padding - barHeight;
                
                if (reactionTimes[i] < 2) {
                    ctx.fillStyle = '#00ff88';
                } else if (reactionTimes[i] < 4) {
                    ctx.fillStyle = '#00d4ff';
                } else {
                    ctx.fillStyle = '#ff0088';
                }
                
                ctx.fillRect(x, y, barWidth - 2, barHeight);
            }
            
            ctx.fillStyle = '#fff';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ååº”æ—¶é—´åˆ†å¸ƒ | ë°˜ì‘ ì‹œê°„ ë¶„í¬', canvas.width / 2, canvas.height - 10);
        }

        // ============================================
        // é‡æ–°å¼€å§‹æ¸¸æˆ
        // ============================================
        function restartGame() {
            document.getElementById('resultScreen').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';
        }
    </script>
</body>
</html>